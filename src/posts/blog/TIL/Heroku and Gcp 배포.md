---
title: "Heroku and GCP ë°°í¬"
category: "TIL"
date: "2022-06-01"
desc: "NodoeJSë¡œ êµ¬í˜„í•œ ì„œë²„ ë°°í¬í•˜ê¸°"
thumbnail: "../images/heroku-gcp.png"
alt: "alt"
---

![](https://images.velog.io/images/c-on/post/b39bd412-458c-4f6b-a860-0c8b37889220/image.png)

# ğŸ”¨ Heroku

í—¤ë¡œì¿ ëŠ” aws, gcpì™€ ê°™ì€ í´ë¼ìš°ë“œ í”Œë«í¼ì´ë‹¤.
í•œ ê³„ì •ë‹¹ ìµœëŒ€ 5ê°œê¹Œì§€ì˜ ì•±ì´ ë¬´ë£Œë¼ì„œ ë°±ìˆ˜ì¸ ë‚´ê°€ ì‚¬ìš©í•˜ê¸° ì¢‹ì€ ê²ƒ ê°™ë‹¤.

ê²°ì œ ì •ë³´ë¥¼ ë“±ë¡í•˜ë©´ MySQL DBë„ ì œê³µí•´ì¤€ë‹¤.

**ë‹¤ë§Œ, ì„œë²„ê°€ ì‚¬ìš©ë˜ì§€ ì•Šì„ ë•ŒëŠ” sleepì— ë¹ ì§„ë‹¤.**
30ë¶„ì •ë„ ì‚¬ìš©í•˜ì§€ ì•Šë‹¤ê°€ ì„œë²„ì— ì ‘ì†í•˜ë©´ ì²˜ìŒì—ëŠ” ì‘ë‹µì„ ë°›ì„ ìˆ˜ ì—†ê¸°ì— ì„œë²„ë¥¼ ê³„ì† ê¹¨ì›Œì£¼ëŠ” í”„ë¡œê·¸ë¨ì´ ìˆëŠ” ê²ƒ ê°™ë‹¤.

> ë‚˜ëŠ” í”„ë¡ íŠ¸ì—”ë“œ ì„œë²„ê°€ GCPì— ë°°í¬ë˜ì–´ìˆì–´ì„œ ì²˜ìŒ ì‚¬ì´íŠ¸ì— ì ‘ì†í•  ë•Œ ì˜ë¯¸ì—†ëŠ” ìš”ì²­ì„ í—¤ë¡œì¿  ì„œë²„ì— ë‚ ë ¤ì„œ ì ì„ ë¯¸ë¦¬ ê¹¨ìš°ëŠ” ë°©ë²•ì„ ì‚¬ìš©í–ˆë‹¤.

ë”°ë¼ì„œ ë°œí‘œë‚˜ í¬íŠ¸í´ë¦¬ì˜¤ ìš©ìœ¼ë¡œ ì‚¬ìš©í•˜ê¸°ì— ì ì ˆí•˜ë©° ì‹¤ì œ ì„œë¹„ìŠ¤ìš©ìœ¼ë¡œ ì‚¬ìš©í•˜ë ¤ë©´ ëˆì„ ë‚´ê³  ì—…ê·¸ë ˆì´ë“œë¥¼ í•˜ë©´ ë˜ì§€ë§Œ ë¹„ìš©ì„ ì§€ë¶ˆí•´ì•¼ í•œë‹¤ë©´ awsë‚˜ gcpë¥¼ ì‚¬ìš©í•˜ëŠ”ê²Œ ë” ì´ë“ì´ì§€ ì‹¶ë‹¤.

## ë°°í¬

### 1. ê°€ì…

ë¨¼ì € [í—¤ë¡œì¿  ì‚¬ì´íŠ¸](https://id.heroku.com/login)ë¡œ ì´ë™í•˜ì—¬ ê°€ì…ì„ ì§„í–‰í•œë‹¤.

---

### 2. ì•± ìƒì„±

![](https://images.velog.io/images/c-on/post/8de25c99-5e81-4536-903f-97d74d1ce69b/image.png)

ê°€ì… í›„ ë¡œê·¸ì¸ì„ í•˜ë©´ ê°œì¸í˜ì´ì§€ì— ì ‘ì†ëœë‹¤.
ìš°ì¸¡ì— new ë²„íŠ¼ì—ì„œ Create new app ë¥¼ í´ë¦­í•´ì¤€ë‹¤.

![](https://images.velog.io/images/c-on/post/259ec891-d2cb-4382-8e7e-3b9a10d8c05e/image.png)

ì•± ì´ë¦„ì€ í”„ë¡œì íŠ¸ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì£¼ëŠ” ì´ë¦„ìœ¼ë¡œ ì§€ì–´ì£¼ê³  ì§€ì—­ì€ ë¯¸êµ­ê³¼ ìœ ëŸ½ì¤‘ì— ê³ ë¥´ëŠ” ê²ƒì´ë¼ì„œ í¬ê²Œ ì°¨ì´ì—†ìœ¼ë¯€ë¡œ ì•„ë¬´ê±°ë‚˜ ì„ íƒí•´ì„œ Create appì„ ëˆŒëŸ¬ì£¼ë©´ ì•± ìƒì„± ì„±ê³µ!

---

### 3. CLIë‹¤ìš´

![](https://images.velog.io/images/c-on/post/b042179b-c551-4626-881b-9a880dd73b9b/image.png)

ìƒì„±í•œ ì•±ì˜ deploy ë©”ë‰´ë¡œ ì´ë™í•˜ë©´ ë°°í¬ ë°©ë²•ì˜ ì•ˆë‚´ê°€ ë³´ì¸ë‹¤.

ê·¸ ì¤‘ ìš°ë¦¬ëŠ” í—¤ë¡œì¿  CLIë¥¼ ë‹¤ìš´í•˜ì—¬ cmdë¡œ í—¤ë¡œì¿  ë°°í¬ë¥¼ ì§„í–‰í•  ê²ƒì´ë‹¤.
[ë‹¤ìš´ë¡œë“œ ì£¼ì†Œ](https://devcenter.heroku.com/articles/heroku-cli#download-and-install)

ë˜í•œ heroku CLIëŠ” GITì´ í•„ìˆ˜ì´ê¸° ë•Œë¬¸ì— ì„¤ì¹˜ë˜ì–´ ìˆì§€ ì•Šë‹¤ë©´ [ì´ê³³](https://git-scm.com/downloads)ì—ì„œ í•¨ê»˜ ì„¤ì¹˜í•´ì¤€ë‹¤.

í„°ë¯¸ë„ì— `heroku --version`ì„ ì…ë ¥í–ˆì„ ë•Œ `heroku/ìˆ«ì ì–´ì©Œê³  ì €ì©Œê³ `ê°€ ë‚˜ì˜¤ë©´ ì„¤ì¹˜ ì„±ê³µ!

---

### 4. CLI ë¡œê·¸ì¸

í„°ë¯¸ë„ì„ ë„ì›Œì„œ `heroku login`ì„ ì…ë ¥í•œë‹¤.

![](https://images.velog.io/images/c-on/post/95332d49-823e-44d7-a5a5-1cd8383e86b1/image.png)

ì´ë ‡ê²Œ ì•„ë¬´ í‚¤ë¥¼ ëˆŒëŸ¬ì£¼ë¼ê³  ëœ¨ë©´ ì •ë§ ì•„ë¬´í‚¤ë‚˜ ëˆŒëŸ¬ì¤€ë‹¤.
ê·¸ëŸ¬ë©´ ë¸Œë¼ìš°ì €ê°€ ì—´ë¦¬ê³  ë¡œê·¸ì¸ ì…ë ¥ ì°½ì´ ë‚˜ì˜¨ë‹¤. ë¡œê·¸ì¸ì„ ì„±ê³µí•˜ë©´

![](https://images.velog.io/images/c-on/post/dbb9fd27-f322-4f19-bd49-b7402f4eec7e/image.png)

ì´ë ‡ê²Œ CLIì—ì„œ ë¡œê·¸ì¸ì´ ì´ë¤„ì§„ë‹¤.

---

### 5. CLIëª…ë ¹ìœ¼ë¡œ ë°°í¬ ë§ˆë¬´ë¦¬

ì´ì œ ëª‡ê°€ì§€ ëª…ë ¹ë§Œìœ¼ë¡œ ì‰½ê²Œ ë°°í¬ë¥¼ í•  ìˆ˜ ìˆë‹¤.

![](https://images.velog.io/images/c-on/post/884d98eb-2a7e-4e69-b413-e9fb90df0da8/image.png)

ë¨¼ì € ë‚´ê°€ ìƒì„±í•œ ì•± ì´ë¦„ì€ `caarcamping`ì´ë¼ì„œ ëª…ë ¹ì— í¬í•¨ëœ `caarcamping`ì€ ìì‹ ì´ ìƒì„±í•œ ì•± ì´ë¦„ìœ¼ë¡œ ë³€ê²½í•´ì„œ ì‚¬ìš©í•œë‹¤.

```
heroku git:clone -a caarcamping
```

ë‚˜ì˜ í—¤ë¡œì¿  ê°€ìƒì„œë²„ì— í”„ë¡œì íŠ¸ ì†ŒìŠ¤ì½”ë“œë¥¼ í´ë¡ í•œë‹¤.

```
$ git add .
$ git commit -am "make it better"
$ git push heroku master
```

ëª…ë ¹ì–´ë¥¼ ì°¨ë¡€ë¡œ ì…ë ¥í•˜ì—¬ í—¤ë¡œì¿  ì›ê²© ì €ì¥ì†Œì— ì†ŒìŠ¤ì½”ë“œë¥¼ ì—…ë¡œë“œ í•´ì¤€ë‹¤.

![](https://images.velog.io/images/c-on/post/9bb3fa87-3503-42b6-9825-c2044a644b22/image.png)

ì´ëŸ° ëª…ë ¹ì¤„ì´ ì´¤ë¼ë½ ëœ¨ë©´

ë°°í¬ ë.

ìˆ˜ì •í•˜ê²Œ ë˜ë©´

```
$ git add .
$ git commit -am "make it better"
$ git push heroku master
```

ì´ ëª…ë ¹ì–´ ë‹¤ì‹œ ì…ë ¥í•´ì£¼ë©´ ëœë‹¤.

---

### tip. ë¸Œëœì¹˜

íŒìœ¼ë¡œ ë°°í¬í•˜ëŠ” ë¸Œëœì¹˜ëŠ” ë‚˜ëˆ„ëŠ” ê²Œ ì¢‹ìœ¼ë‹ˆê¹Œ

```
git checkout -b heroku-deploy
```

ë¡œ ë¸Œëœì¹˜ë¥¼ ìƒì„±í•˜ê³ 

```
git push heroku heroku-deploy:master
```

ë¥¼ ëª…ë ¹í•´ì„œ ë°°í¬í•  ìˆ˜ë„ ìˆë‹¤.

> GIT ê°œë…ì´ ì—†ìœ¼ë©´ ë¸Œëœì¹˜ ë³€ê²½í•˜ê±°ë‚˜ push, pull ê¼¬ì¼ ìˆ˜ ìˆìœ¼ë‹ˆ ë¸Œëœì¹˜ë¥¼ ìƒì„±í• ê±°ë©´ GIT ê³µë¶€ë¥¼ ë¨¼ì € í•´ì•¼í•¨.

---

<br>

# ğŸ”¨ GCP

GCPëŠ” google cloud platformì´ë‹¤.

GCPì—ëŠ” app engineì´ë¼ëŠ” í”Œë«í¼ì´ ìˆë‹¤. ë¹„êµì  ì‰¬ìš´ ë°°í¬ ì„œë¹„ìŠ¤ë¥¼ ì œê³µí•œë‹¤.
êµ¬ê¸€ ì›¹ì‚¬ì´íŠ¸ì— ì‚¬ìš©ë˜ëŠ” ê²ƒê³¼ ë™ì¼í•œ ê¸°ìˆ ì´ ì‚¬ìš©ë˜ì–´ ì•±ì—”ì§„ì„ í†µí•´ ë°°í¬ë¥¼ í•˜ë©´ ì½”ë“œë§Œ ì œê³µí•´ì£¼ë©´ ì¸í”„ë¼ëŠ” ì•Œì•„ì„œ ê´€ë¦¬í•´ì¤€ë‹¤.

AWSì—ì„œ ë°°í¬ë¥¼ í•˜ê²Œë˜ë©´ EC2+ë¡œë“œë°¸ëŸ°ì„œ+route53 ... ë“± ì„¤ì •í•  ê²ƒì´ ë§ì€ ë°˜ë©´ ì•±ì—”ì§„ì€ ë§ì€ ì„¤ì •ë“¤ì„ ìë™ìœ¼ë¡œ í˜¹ì€ ê°„ë‹¨í•œ ì˜µì…˜ìœ¼ë¡œ ê´€ë¦¬í•´ì£¼ë©° ë¬´ì¤‘ë‹¨ ì„œë¹„ìŠ¤ë„ ì•Œì•„ì„œ í•´ì¤€ë‹¤. ğŸ‘

## ë¬¸ì„œë³´ê¸°

[GCPë¬¸ì„œ](https://cloud.google.com/appengine/docs/flexible/nodejs?hl=ko)ëŠ” ì •ë§ ì˜ ì •ë¦¬ë˜ì–´ìˆë‹¤. ë³´ê¸° ê¹”ë”í•˜ë©° ë²ˆì—­ë„ ì˜ë˜ì–´ìˆë‹¤. ë‹¨ì ì€ í•„ìš”í•œ ë‚´ìš©ì´ ì–´ë””ì— ìˆëŠ”ì§€ ëª»ì°¾ì„ ê²½ìš° êµ¬ê¸€ë§ì„ í•´ì•¼í•˜ëŠ”ë° í•œê¸€ë¡œ ëœ ì •ë³´ê°€ ë§ì§€ ì•Šë‹¤ëŠ” ê²ƒ.

## ë°°í¬

### 1. [GCPì— í”„ë¡œì íŠ¸ ìƒì„±](https://console.cloud.google.com/home)

[êµ¬ê¸€í´ë¼ìš°ë“œí”Œë«í¼](cloud.google.com)ìœ¼ë¡œ ì´ë™í•´ì„œ ê°€ì…í•˜ê³  ë¡œê·¸ì¸í•œë‹¤.

ì¹´ë“œ ê³„ì • ë“±ë¡ì„ í•´ì•¼ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤.
ì¡°ê¸ˆ ê·€ì°®ì§€ë§Œ ì¹´ë“œë‘ ë¯¼ì¦ ì°ì–´ì„œ ì¸ì¦í•´ì•¼ êµ¬ê¸€ì—ì„œ í™•ì¸ í›„ì— ë“±ë¡ì„ ì‹œì¼œì¤¬ë˜ ê±¸ë¡œ ê¸°ì–µí•œë‹¤.

ì—¬íŠ¼ ê³„ì •ì´ ìƒì„±ë˜ë©´

![](https://images.velog.io/images/c-on/post/fe1f282b-988c-4f23-9d18-7ba8a26429a2/image.png)

ì™¼ìª½ ìƒë‹¨ Google Cloud Platform ì˜¤ë¥¸ìª½ì— í”„ë¡œì íŠ¸ ì–´ì©Œê³ ìˆì„í…ë°(ì‚¬ì§„ì—ì„  í”„ë¡œì íŠ¸ê°€ ì¡´ì¬í•´ì„œ `caarcamping`ì´ë¼ëŠ” í”„ë¡œì íŠ¸ëª…ìœ¼ë¡œ ë‚˜ì™€ìˆìŒ) ê·¸ê²ƒì„ í´ë¦­.

`í”„ë¡œì íŠ¸ ì„ íƒ` ë‹¤ì´ì–¼ë¡œê·¸ê°€ ë‚˜ì˜¤ë©´ ì˜¤ë¥¸ìª½ ìƒë‹¨ì˜ `ìƒˆ í”„ë¡œì íŠ¸`ë¥¼ í´ë¦­í•´ì„œ ë‚˜ì˜ í”„ë¡œì íŠ¸ë¥¼ ëŒ€í‘œí•´ì£¼ëŠ” ì´ë¦„ìœ¼ë¡œ í•˜ë‚˜ ìƒì„±í•´ì¤€ë‹¤.

---

### 2. [App Engine](https://console.cloud.google.com/appengine)

í”„ë¡œì íŠ¸ ìƒì„±ì„ ë§ˆì¹˜ë©´ ì™¼ìª½ ë©”ë‰´ë¥¼ í´ë¦­í•´ì„œ `App Engine` ì„ ì°¾ì•„ì„œ ì´ë™í•˜ê±°ë‚˜ `ì œí’ˆ ë° ë¦¬ì†ŒìŠ¤ ê²€ìƒ‰`ì´ë¼ëŠ” ê²€ìƒ‰ì°½ì— ì…ë ¥í•´ì„œ ì´ë™í•œë‹¤.

ë‚˜ì™€ìˆëŠ” ì•ˆë‚´ì— ë”°ë¼ ì˜ ë”°ë¼ê°€ì£¼ë©´ ëœë‹¤.

Regionì„ íƒì€ ìš°ë¦¬ë‚˜ë¼ë‘ ê°€ê¹Œìš´ê±° í•´ì£¼ê³  LangaugeëŠ” nodeJSë¡œ ì„ íƒí•´ì¤€ë‹¤

---

### 3. [Cloud SDK](https://cloud.google.com/sdk/docs/install?hl=ko)

[ë‹¤ìš´ë¡œë“œë¬¸ì„œ](https://cloud.google.com/sdk/docs/install?hl=ko#installation_instructions)ë¡œ ì´ë™í•˜ì—¬ SDKë¥¼ ì„¤ì¹˜í•´ì¤€ë‹¤.

ì´ë¯¸ ì„¤ì¹˜í•œ ê²½ìš° ë„˜ì–´ê°€ê¸°

---

### 4. [app.yamlë¡œ ì•± êµ¬ì„±](https://cloud.google.com/appengine/docs/flexible/nodejs/configuring-your-app-with-app-yaml?hl=ko#intro)

ë²„ì „ê³¼ URLì´ í¬í•¨ëœ Node.js ì•±ì˜ ëŸ°íƒ€ì„ êµ¬ì„±ì„ app.yaml íŒŒì¼ì— ì§€ì •í•  ìˆ˜ ìˆë‹¤. ì´ íŒŒì¼ì€ íŠ¹ì • ì„œë¹„ìŠ¤ ë²„ì „ì˜ ë°°í¬ ì„¤ëª…ì ì—­í• ì„ í•œë‹¤.

ì„œë²„ë¥¼ êµ¬ë™í•˜ëŠ” íŒŒì¼ê³¼ ë™ì¼ ê²½ë¡œì— `app.yaml` íŒŒì¼ì„ ìƒì„±í•œë‹¤.

```
runtime: nodejs
env: flex

manual_scaling:
  instances: 1
resources:
  cpu: 1
  memory_gb: 0.5
  disk_size_gb: 10
```

app.yamlì— ë‹¤ìŒ ì½”ë“œë¥¼ ì‘ì„±í•´ì¤€ë‹¤.
ìµœëŒ€í•œ ê³¼ê¸ˆì´ ì•ˆë˜ë„ë¡ í•˜ë“œì›¨ì–´ë¥¼ ì €ì €ì €ìš©ëŸ‰ìœ¼ë¡œ ì…‹íŒ…í–ˆë‹¤.

ë ˆì§„ì½”ë¯¹ìŠ¤ê°€ ì•±ì—”ì§„ìœ¼ë¡œ ì„œë²„ë¥¼ ê´€ë¦¬í•œë‹¤ëŠ”ë° ì´ë ‡ê²Œ ì‹¤ì œ ì„œë¹„ìŠ¤ë¥¼ í•  ë•ŒëŠ”

```
runtime: nodejs
env: flex
```

ì´ ì½”ë“œë§Œ ì ì–´ì£¼ë©´ ìë™ìœ¼ë¡œ êµ¬ê¸€ì´ íŠ¸ë˜í”½ì— ë§ì¶° ì‚¬ì–‘ì„ ì¡°ì ˆí•´ì¤€ë‹¤.

> app.yamlíŒŒì¼ì— í¬íŠ¸ë¥¼ ì§€ì •í•´ì£¼ì§€ ì•Šìœ¼ë©´ ë””í´íŠ¸ë¡œ 8080í¬íŠ¸ë¥¼ ì‚¬ìš©í•œë‹¤. í¬íŠ¸ë¥¼ ë³€ê²½í•˜ë ¤ë©´ [ì´ ë¬¸ì„œ](https://cloud.google.com/appengine/docs/flexible/nodejs/reference/app-yaml?hl=ko#network_settings)ë¥¼ ì°¸ê³ í•œë‹¤.

---

### 4. [Node.jsìš© Google Cloud í´ë¼ì´ì–¸íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì„¤ì¹˜](https://cloud.google.com/appengine/docs/flexible/nodejs/using-nodejs-libraries?hl=ko#installing_google_cloud_client_libraries_for_nodejs)

```
npm install --save @google-cloud/storage
```

Node.jsìš© Google Cloud í´ë¼ì´ì–¸íŠ¸ ë¼ì´ë¸ŒëŸ¬ë¦¬ëŠ” Node.js ê°œë°œìê°€ Cloud Datastore, Cloud Storage ë“±ì˜ Google Cloud Platform ì„œë¹„ìŠ¤ì™€ í†µí•©í•˜ëŠ” ë° ì¼ë°˜ì ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì´ë‹¤.

ìœ„ ëª…ë ¹ì–´ë¡œ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì„¤ì¹˜í•œë‹¤.

---

### 5. [ì• í”Œë¦¬ì¼€ì´ì…˜ ë°°í¬](https://cloud.google.com/appengine/docs/flexible/nodejs/testing-and-deploying-your-app?hl=ko#deploying_your_application)

gcloudì— ë¡œê·¸ì¸ í•œ ì ì´ ì—†ë‹¤ë©´ `gcloud init`ì„ CLIì— ì…ë ¥í•˜ì—¬ ë¡œê·¸ì¸ì„ ì§„í–‰í•œë‹¤.

ë¡œê·¸ì¸ì´ ëœ ìƒíƒœë¼ë©´ cliì˜ ê²½ë¡œë¥¼ í”„ë¡œì íŠ¸ í´ë”ë¡œ ì´ë™í•œ ë’¤ `gcloud app deploy`ë¥¼ ì…ë ¥í•œë‹¤.

ì ê¹ ê¸°ë‹¤ë¦¬ë©´ ê³„ì†í•  ê±°ëƒê³  ë¬¼ì–´ë³¸ë‹¤. `y`ë¥¼ ì…ë ¥í•´ì¤€ë‹¤.

ì´ì œ ì¢€ ê±¸ë¦°ë‹¤.

3~5ë¶„ ë’¤ì— ë¹Œë“œì— ì„±ê³µí–ˆë‹¤ê³  ëœ¬ë‹¤.

ì´ì œ `gcloud app browse`ë¥¼ ì…ë ¥í•˜ë©´ ë¸Œë¼ìš°ì €ì— ë°°í¬ëœ ì•±ì´ ë‚˜íƒ€ë‚œë‹¤!
